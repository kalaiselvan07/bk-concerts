time=2025-10-30T21:00:19.802+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:00:19.803+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:00:19.804+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:00:19.804+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:00:19.804+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:00:19.804+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:00:23.043+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:00:23.049+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:00:23.055+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:00:23.055+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:00:23.055+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:00:23.363+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:00:23.363+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:00:23.666+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:00:23.666+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:00:24.140+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:00:24.140+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:00:24.587+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:00:24.587+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:00:25.707+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:00:25.713+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:00:26.113+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:00:26.123+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:00:26.631+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:00:26.635+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:00:26.635+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:00:26.636+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:00:26.636+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:00:38.341+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:00:38.341+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:00:38.342+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:00:38.342+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:00:38.343+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:00:39.433+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T21:00:39.447+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:00:39.448+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:00:39.449+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:00:39.449+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:00:39.450+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:00:39.772+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T21:00:43.881+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:00:43.882+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:00:43.882+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:00:43.882+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:00:45.698+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 0 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:00:45.710+05:30 level=INFO msg="[booking] Successfully retrieved 0 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:01:06.292+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:06.293+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:01:06.622+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 14c7770d-c354-4df9-85e1-9c1757a8acbc"
time=2025-10-30T21:01:08.712+05:30 level=WARN msg="[get-seat-uc] Transactional lock failed for 14c7770d-c354-4df9-85e1-9c1757a8acbc: Seat not found."
time=2025-10-30T21:01:50.516+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:50.517+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:01:50.517+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:01:50.518+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:50.519+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:01:50.519+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:01:50.519+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:50.521+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:01:50.521+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:01:50.848+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:01:50.856+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:50.860+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:01:50.861+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:01:51.250+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:01:54.003+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:01:54.021+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:54.030+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:01:54.033+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:01:54.216+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:01:54.219+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:01:54.220+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:01:54.221+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:01:54.418+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:01:54.611+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:02:37.366+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:02:37.366+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:02:37.737+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 1adb1847-8b9e-48c1-9c90-17fa66efee4a"
time=2025-10-30T21:02:39.205+05:30 level=INFO msg="[get-seat-uc] Seat 1adb1847-8b9e-48c1-9c90-17fa66efee4a successfully locked for update. Current Available: 194"
time=2025-10-30T21:02:39.205+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 1adb1847-8b9e-48c1-9c90-17fa66efee4a. New count: 193"
time=2025-10-30T21:02:40.092+05:30 level=INFO msg="[update-seat-uc] Seat 1adb1847-8b9e-48c1-9c90-17fa66efee4a availability updated to 193 within transaction."
time=2025-10-30T21:02:40.092+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:02:40.093+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: 5456bd0f-1900-452c-9975-c686051f29ab for Name: adsfas"
time=2025-10-30T21:02:40.924+05:30 level=INFO msg="[create-participant-uc] Participant 5456bd0f-1900-452c-9975-c686051f29ab inserted successfully within transaction."
time=2025-10-30T21:02:42.400+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: 4572e33c-68a6-49eb-852a-1404bea3313d"
time=2025-10-30T21:02:42.411+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: blackticketentertainments.ge@gmail.com"
time=2025-10-30T21:02:43.341+05:30 level=INFO msg="[auth] ✅ Email sent to blackticketentertainments.ge@gmail.com via Resend."
time=2025-10-30T21:02:43.341+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: 4572e33c-68a6-49eb-852a-1404bea3313d"
time=2025-10-30T21:02:47.195+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:02:47.197+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:02:47.198+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:02:47.198+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:02:48.717+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:02:48.718+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:02:53.076+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:02:53.076+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:02:53.076+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:02:53.076+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:02:53.076+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:02:54.436+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:02:54.442+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:02:54.442+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:02:54.444+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:02:54.444+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:02:54.445+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:02:55.523+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:04:12.747+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:04:12.752+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:04:12.752+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:04:12.753+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:04:12.753+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:04:12.754+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:04:17.642+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:04:17.645+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:04:17.645+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:04:17.645+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:04:17.645+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:04:17.985+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:04:17.989+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:04:18.375+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:04:18.386+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:04:18.807+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:04:18.807+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:04:19.133+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:04:19.133+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:04:19.521+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:04:19.525+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:04:19.948+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:04:19.949+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:04:21.980+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:04:21.982+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:04:21.982+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:04:21.983+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:04:21.983+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:04:21.983+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:04:21.984+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:04:21.984+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:04:21.985+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:04:21.985+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:04:21.985+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:04:38.049+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:04:38.049+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:04:38.051+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:04:38.051+05:30 level=INFO msg="[booking-controller] Verification requested: 4572e33c-68a6-49eb-852a-1404bea3313d → approve"
time=2025-10-30T21:04:38.052+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 4572e33c-68a6-49eb-852a-1404bea3313d"
time=2025-10-30T21:04:45.125+05:30 level=INFO msg="[approve-booking-uc] Booking 4572e33c-68a6-49eb-852a-1404bea3313d marked APPROVED."
time=2025-10-30T21:04:45.127+05:30 level=INFO msg="[approve-booking-uc] PDF generated successfully for 4572e33c-68a6-49eb-852a-1404bea3313d"
time=2025-10-30T21:04:47.332+05:30 level=INFO msg="[auth] ✅ Email sent to kalaiselvan7834@gmail.com via Resend."
time=2025-10-30T21:04:47.333+05:30 level=INFO msg="[approve-booking-uc] Approval email with PDF sent to kalaiselvan7834@gmail.com"
time=2025-10-30T21:04:48.883+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:04:48.883+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:04:48.883+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:04:48.885+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:04:48.885+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:04:49.324+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T21:04:50.099+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:04:50.099+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T21:04:50.099+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:04:50.100+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T21:04:50.101+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T21:04:53.711+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 1 total bookings for admin."
time=2025-10-30T21:05:43.187+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:43.190+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:05:43.190+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:05:43.190+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:43.190+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:43.191+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:05:43.192+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:05:43.191+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:05:43.193+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:05:43.596+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:05:43.601+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:43.601+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:05:43.602+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:05:44.505+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:05:47.078+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:05:47.090+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:47.094+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:05:47.095+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:05:47.438+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:05:47.794+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:05:47.796+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:47.797+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:05:47.797+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:05:48.191+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:05:49.027+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:05:49.028+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:05:49.028+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:05:49.029+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:05:50.560+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:05:50.561+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:06:40.347+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:06:40.347+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:06:40.736+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 9bf79acc-5df2-4f63-a2ec-94523823af91"
time=2025-10-30T21:06:41.556+05:30 level=INFO msg="[get-seat-uc] Seat 9bf79acc-5df2-4f63-a2ec-94523823af91 successfully locked for update. Current Available: 200"
time=2025-10-30T21:06:41.557+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 9bf79acc-5df2-4f63-a2ec-94523823af91. New count: 199"
time=2025-10-30T21:06:42.419+05:30 level=INFO msg="[update-seat-uc] Seat 9bf79acc-5df2-4f63-a2ec-94523823af91 availability updated to 199 within transaction."
time=2025-10-30T21:06:42.420+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:06:42.420+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: ea546216-8b0a-4c81-a5aa-08cb8b77327e for Name: selvan"
time=2025-10-30T21:06:43.304+05:30 level=INFO msg="[create-participant-uc] Participant ea546216-8b0a-4c81-a5aa-08cb8b77327e inserted successfully within transaction."
time=2025-10-30T21:06:45.821+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: a9ea5539-0c33-4333-a3b4-9be09eeaf7da"
time=2025-10-30T21:06:45.826+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: blackticketentertainments.ge@gmail.com"
time=2025-10-30T21:06:47.642+05:30 level=INFO msg="[auth] ✅ Email sent to blackticketentertainments.ge@gmail.com via Resend."
time=2025-10-30T21:06:47.648+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: a9ea5539-0c33-4333-a3b4-9be09eeaf7da"
time=2025-10-30T21:11:07.046+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:11:07.048+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:11:07.048+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:11:07.048+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:11:07.048+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:11:07.049+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:11:07.163+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:11:07.163+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:11:07.163+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:11:07.163+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:11:07.163+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:11:07.164+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:11:07.164+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:11:07.164+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:11:07.165+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:11:07.165+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:11:07.165+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:11:07.166+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:11:07.167+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:11:07.167+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:12:53.775+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:12:53.776+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:12:53.776+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:12:53.776+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:12:53.776+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:12:53.781+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:12:53.783+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:12:53.783+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:12:53.784+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:12:53.784+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:12:53.784+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:12:53.785+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:12:57.754+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:12:57.755+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:12:57.756+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:12:57.756+05:30 level=INFO msg="[booking-controller] Verification requested: 81155491-05ed-45cc-9d84-9d9d16336a8f → approve"
time=2025-10-30T21:12:57.757+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 81155491-05ed-45cc-9d84-9d9d16336a8f"
time=2025-10-30T21:12:57.772+05:30 level=INFO msg="[approve-booking-uc] Booking 81155491-05ed-45cc-9d84-9d9d16336a8f marked APPROVED."
time=2025-10-30T21:12:57.778+05:30 level=INFO msg="[approve-booking-uc] PDF generated successfully for 81155491-05ed-45cc-9d84-9d9d16336a8f"
time=2025-10-30T21:12:59.621+05:30 level=INFO msg="[auth] ✅ Email sent to kalaiselvan7834@gmail.com via Resend."
time=2025-10-30T21:12:59.622+05:30 level=INFO msg="[approve-booking-uc] Approval email with PDF sent to kalaiselvan7834@gmail.com"
time=2025-10-30T21:13:02.613+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:13:02.613+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:13:02.614+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:13:02.614+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:13:02.614+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:13:02.616+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T21:13:10.636+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:10.637+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:10.637+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:13:10.637+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:10.637+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:13:10.639+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:13:10.642+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:13:10.642+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:13:10.644+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:13:10.648+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:13:10.650+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:10.651+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:13:10.651+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:13:10.654+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:13:11.009+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:13:11.013+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.014+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:13:11.014+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.015+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:13:11.081+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:13:11.086+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.086+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:13:11.088+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.089+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:13:11.796+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.797+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:13:11.797+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.798+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:13:11.806+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.808+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:13:11.806+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.806+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.808+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.809+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:13:11.810+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:13:11.811+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.811+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.811+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:13:11.815+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:13:11.816+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:13:11.818+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.818+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:13:11.819+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.819+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:11.819+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:13:11.819+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:13:11.819+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:13:11.820+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:13:21.663+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:21.664+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:13:21.665+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:13:21.665+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:13:21.677+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:13:21.678+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:13:48.581+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:48.583+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:13:48.585+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 69a0b445-c3d5-4e23-bad1-e8f92f064bcf"
time=2025-10-30T21:13:48.589+05:30 level=INFO msg="[get-seat-uc] Seat 69a0b445-c3d5-4e23-bad1-e8f92f064bcf successfully locked for update. Current Available: 100"
time=2025-10-30T21:13:48.590+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 69a0b445-c3d5-4e23-bad1-e8f92f064bcf. New count: 99"
time=2025-10-30T21:13:48.596+05:30 level=INFO msg="[update-seat-uc] Seat 69a0b445-c3d5-4e23-bad1-e8f92f064bcf availability updated to 99 within transaction."
time=2025-10-30T21:13:48.597+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:13:48.598+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: 45142f04-a8fb-4ca1-ad4e-fe7668bfaba6 for Name: Kalai"
time=2025-10-30T21:13:48.602+05:30 level=INFO msg="[create-participant-uc] Participant 45142f04-a8fb-4ca1-ad4e-fe7668bfaba6 inserted successfully within transaction."
time=2025-10-30T21:13:48.620+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:13:48.621+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T21:13:49.263+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T21:13:49.264+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:13:58.492+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:13:58.494+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:13:58.495+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:13:58.495+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:13:58.501+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 2 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:13:58.501+05:30 level=INFO msg="[booking] Successfully retrieved 2 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:17:49.767+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:49.768+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:17:49.768+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:17:49.768+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:49.769+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:17:49.769+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:17:49.769+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:49.770+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:17:49.770+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:17:49.771+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:17:49.771+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:17:49.771+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:17:49.774+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:49.775+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:17:49.776+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:17:49.777+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:49.778+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:49.778+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:17:49.778+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:17:49.778+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:17:49.779+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:17:49.779+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:17:49.779+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:17:49.780+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:17:51.285+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:17:51.286+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:17:51.287+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:17:51.288+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:17:51.292+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 2 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:17:51.293+05:30 level=INFO msg="[booking] Successfully retrieved 2 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:17:55.417+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:17:55.417+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T21:17:55.417+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:17:55.418+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T21:17:55.419+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T21:17:55.421+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 2 total bookings for admin."
time=2025-10-30T21:18:00.698+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:18:00.699+05:30 level=INFO msg="[booking] Fetching receipt for bookingID: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:00.699+05:30 level=INFO msg="[get-booking-receipt-uc] Fetching booking receipt for BookingID: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:00.702+05:30 level=INFO msg="[get-booking-receipt-uc] Booking receipt successfully retrieved for 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:00.702+05:30 level=INFO msg="[booking] Booking receipt fetched successfully for 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:02.805+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:18:02.805+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:18:02.806+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:18:02.807+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:18:02.807+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:18:02.809+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:18:05.221+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:18:05.222+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T21:18:05.223+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:18:05.223+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T21:18:05.226+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T21:18:05.229+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 2 total bookings for admin."
time=2025-10-30T21:18:06.440+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:18:06.441+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:18:06.442+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:18:06.442+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:18:06.442+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:18:06.446+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:18:14.073+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:18:14.073+05:30 level=INFO msg="[booking] Fetching receipt for bookingID: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:14.073+05:30 level=INFO msg="[get-booking-receipt-uc] Fetching booking receipt for BookingID: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:14.075+05:30 level=INFO msg="[get-booking-receipt-uc] Booking receipt successfully retrieved for 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:14.075+05:30 level=INFO msg="[booking] Booking receipt fetched successfully for 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:24.006+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:18:24.006+05:30 level=INFO msg="[update-booking-receipt-uc] 🚀 Starting receipt re-upload for booking 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:24.008+05:30 level=INFO msg="[update-booking-receipt-uc] 🧾 Transaction started for booking 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:24.011+05:30 level=INFO msg="[update-booking-receipt-uc] ✅ DB updated and committed for booking 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:24.012+05:30 level=INFO msg="[update-booking-receipt-uc] 🎯 Receipt re-upload completed for booking 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:18:24.012+05:30 level=INFO msg="[booking] Receipt updated successfully for booking 6f2c9edc-774a-4356-b5f1-c444c8499755."
time=2025-10-30T21:18:25.362+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T21:18:25.362+05:30 level=INFO msg="[update-booking-receipt-uc] ✉️ Admin notified of re-upload for booking 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:25:32.811+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:25:32.813+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:25:32.814+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:25:32.814+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:25:32.815+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:25:32.815+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:25:32.991+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:25:32.991+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:25:32.991+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:25:32.992+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:25:32.992+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:25:32.995+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:25:32.995+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:25:32.996+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:25:32.997+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:25:32.998+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:25:32.999+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:25:33.001+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:25:33.001+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:25:33.003+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:25:33.003+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:25:33.005+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:25:33.006+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:25:33.008+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:25:33.008+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:25:33.009+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:25:33.010+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:25:33.010+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:25:33.011+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:25:33.013+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:25:33.013+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:25:33.014+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:25:33.015+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:25:33.015+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:26:05.042+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:05.042+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:26:05.043+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:05.043+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:26:05.043+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:26:05.046+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:26:05.049+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:05.049+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:26:05.050+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:05.050+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:26:05.051+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:26:05.051+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:26:10.273+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:10.273+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:26:10.273+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:10.273+05:30 level=INFO msg="[booking-controller] Verification requested: 6f2c9edc-774a-4356-b5f1-c444c8499755 → approve"
time=2025-10-30T21:26:10.274+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:26:10.279+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column s.concert_id does not exist"
time=2025-10-30T21:26:10.280+05:30 level=ERROR msg="[booking-controller] Approval failed for 6f2c9edc-774a-4356-b5f1-c444c8499755: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:26:14.424+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:14.424+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:26:14.424+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:14.424+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:26:14.424+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:26:14.425+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:26:14.427+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:14.427+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:26:14.427+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:14.427+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:26:14.427+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:26:14.429+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:26:19.283+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:19.283+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:26:19.283+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:19.284+05:30 level=INFO msg="[booking-controller] Verification requested: 6f2c9edc-774a-4356-b5f1-c444c8499755 → reject"
time=2025-10-30T21:26:19.284+05:30 level=INFO msg="[reject-booking-uc] Starting rejection for booking: 6f2c9edc-774a-4356-b5f1-c444c8499755"
time=2025-10-30T21:26:19.286+05:30 level=INFO msg="[reject-booking-uc] Booking 6f2c9edc-774a-4356-b5f1-c444c8499755 successfully marked as REJECTED."
time=2025-10-30T21:26:19.287+05:30 level=INFO msg="[auth] Sending booking verification email (Status: REJECTED) to kalaiselvan7834@gmail.com"
time=2025-10-30T21:26:20.370+05:30 level=INFO msg="[auth] ✅ Email sent to kalaiselvan7834@gmail.com via Resend."
time=2025-10-30T21:26:20.370+05:30 level=INFO msg="[reject-booking-uc] Rejection email sent to kalaiselvan7834@gmail.com."
time=2025-10-30T21:26:22.599+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:26:22.599+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:26:22.600+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:26:22.601+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:26:22.602+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:26:22.605+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T21:26:46.698+05:30 level=INFO msg="[auth] Login initiated for email: kalaiselvan7834@gmail.com. Password provided: false"
time=2025-10-30T21:26:46.701+05:30 level=INFO msg="[auth] Initiating OTP flow for regular user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:26:46.702+05:30 level=INFO msg="[auth] Starting OTP process for email: kalaiselvan7834@gmail.com"
time=2025-10-30T21:26:46.703+05:30 level=INFO msg="[user] Attempting to retrieve user by email: kalaiselvan7834@gmail.com"
time=2025-10-30T21:26:46.713+05:30 level=INFO msg="[user] User kalaiselvan7834@gmail.com found successfully. Role: user."
time=2025-10-30T21:26:46.713+05:30 level=INFO msg="[auth] User kalaiselvan7834@gmail.com found. Role: user. Reissuing OTP."
time=2025-10-30T21:26:46.714+05:30 level=INFO msg="[auth] Generated OTP code: 395666"
time=2025-10-30T21:26:46.725+05:30 level=INFO msg="[auth] OTP saved/updated successfully. Expires at: 2025-10-30T21:31:46+05:30"
time=2025-10-30T21:26:46.725+05:30 level=INFO msg="[auth] Sending OTP email to kalaiselvan7834@gmail.com"
time=2025-10-30T21:26:47.202+05:30 level=INFO msg="[auth] ✅ Email sent to kalaiselvan7834@gmail.com via Resend."
time=2025-10-30T21:26:47.203+05:30 level=INFO msg="[auth] OTP dispatch triggered for kalaiselvan7834@gmail.com."
time=2025-10-30T21:26:47.203+05:30 level=INFO msg="[auth] OTP generated and request initiated for kalaiselvan7834@gmail.com. Awaiting verification."
time=2025-10-30T21:27:07.107+05:30 level=INFO msg="[auth] Attempting OTP verification for email: kalaiselvan7834@gmail.com"
time=2025-10-30T21:27:07.107+05:30 level=INFO msg="[auth] Verification attempt for email: kalaiselvan7834@gmail.com"
time=2025-10-30T21:27:07.108+05:30 level=INFO msg="[user] Attempting to retrieve user by email: kalaiselvan7834@gmail.com"
time=2025-10-30T21:27:07.111+05:30 level=INFO msg="[user] User kalaiselvan7834@gmail.com found successfully. Role: user."
time=2025-10-30T21:27:07.112+05:30 level=INFO msg="[auth] User kalaiselvan7834@gmail.com found. Proceeding to OTP validation."
time=2025-10-30T21:27:07.117+05:30 level=INFO msg="[auth] OTP code matched for kalaiselvan7834@gmail.com. Checking expiry..."
time=2025-10-30T21:27:07.121+05:30 level=INFO msg="[auth] OTP cleaned up successfully for kalaiselvan7834@gmail.com."
time=2025-10-30T21:27:07.123+05:30 level=INFO msg="[auth] Successfully generated JWT for user 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c (Role: user)."
time=2025-10-30T21:27:07.123+05:30 level=INFO msg="[auth] Verification successful for kalaiselvan7834@gmail.com. JWT issued. Role: user."
time=2025-10-30T21:27:07.124+05:30 level=INFO msg="[auth] OTP verified successfully for kalaiselvan7834@gmail.com. JWT issued. Role: user"
time=2025-10-30T21:27:09.171+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:09.172+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:27:09.172+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:27:09.172+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:09.173+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:27:09.173+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:27:09.176+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:09.177+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:27:09.177+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:27:09.183+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:27:09.190+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:27:09.192+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:09.193+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:27:09.194+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:27:09.195+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:09.196+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:27:09.200+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:27:09.199+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:27:09.203+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:27:09.535+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:27:09.538+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:09.538+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:27:09.538+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:27:09.539+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:27:28.543+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:28.547+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:27:28.552+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 6d909559-7054-47dc-8bd1-e8b566a82bbb"
time=2025-10-30T21:27:28.555+05:30 level=INFO msg="[get-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb successfully locked for update. Current Available: 100"
time=2025-10-30T21:27:28.557+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 6d909559-7054-47dc-8bd1-e8b566a82bbb. New count: 99"
time=2025-10-30T21:27:28.562+05:30 level=INFO msg="[update-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb availability updated to 99 within transaction."
time=2025-10-30T21:27:28.562+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:27:28.565+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: e592b845-154d-4eb5-bf0a-7feb8cd9f67f for Name: Kalai"
time=2025-10-30T21:27:28.569+05:30 level=INFO msg="[create-participant-uc] Participant e592b845-154d-4eb5-bf0a-7feb8cd9f67f inserted successfully within transaction."
time=2025-10-30T21:27:28.583+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:27:28.584+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T21:27:29.214+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T21:27:29.215+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:27:32.271+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:27:32.271+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:27:32.272+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:27:32.272+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:27:32.277+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 3 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:27:32.277+05:30 level=INFO msg="[booking] Successfully retrieved 3 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:27:35.461+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:27:35.461+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T21:27:35.462+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:27:35.462+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T21:27:35.462+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T21:27:35.465+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 3 total bookings for admin."
time=2025-10-30T21:27:37.411+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:27:37.412+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:27:37.413+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:27:37.414+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:27:37.416+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:27:37.422+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:27:41.188+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:27:41.189+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:27:41.191+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:27:41.192+05:30 level=INFO msg="[booking-controller] Verification requested: 38f04f5a-11fb-4941-8c03-42c57fc32258 → approve"
time=2025-10-30T21:27:41.193+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:27:41.204+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column s.concert_id does not exist"
time=2025-10-30T21:27:41.209+05:30 level=ERROR msg="[booking-controller] Approval failed for 38f04f5a-11fb-4941-8c03-42c57fc32258: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:44:13.839+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:44:13.839+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:44:13.840+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:44:13.839+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:44:13.841+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:44:13.841+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:44:13.842+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:44:13.843+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:44:13.843+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:44:13.847+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:44:13.849+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:44:14.086+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:44:27.031+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:44:27.033+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:44:27.033+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:44:27.033+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:44:27.033+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:44:27.033+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:44:27.207+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:44:27.207+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:44:27.207+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:44:27.207+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:44:27.207+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:44:27.209+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:44:27.209+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:44:27.209+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:44:27.209+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:44:27.209+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:44:27.210+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:44:27.210+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:44:27.210+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:44:27.210+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:44:27.210+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:44:27.210+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:44:27.211+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:44:27.211+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:44:27.211+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:44:27.211+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:44:27.212+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:44:27.212+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:44:27.213+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:44:27.213+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:44:27.213+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:44:27.213+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:44:27.213+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:44:27.214+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:45:38.045+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:45:38.045+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:45:38.046+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:45:38.048+05:30 level=INFO msg="[booking-controller] Verification requested: 38f04f5a-11fb-4941-8c03-42c57fc32258 → approve"
time=2025-10-30T21:45:38.049+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:45:38.063+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column \"concert_name\" does not exist"
time=2025-10-30T21:45:38.068+05:30 level=ERROR msg="[booking-controller] Approval failed for 38f04f5a-11fb-4941-8c03-42c57fc32258: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:45:43.873+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:45:43.873+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:45:43.873+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:45:43.873+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:45:43.873+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:45:43.875+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:45:43.877+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:45:43.877+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:45:43.877+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:45:43.877+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:45:43.877+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:45:43.879+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:45:46.166+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:45:46.167+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:45:46.167+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:45:46.167+05:30 level=INFO msg="[booking-controller] Verification requested: 38f04f5a-11fb-4941-8c03-42c57fc32258 → approve"
time=2025-10-30T21:45:46.168+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:45:46.174+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column \"concert_name\" does not exist"
time=2025-10-30T21:45:46.178+05:30 level=ERROR msg="[booking-controller] Approval failed for 38f04f5a-11fb-4941-8c03-42c57fc32258: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:45:58.436+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:45:58.436+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:45:58.437+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:45:58.437+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:45:58.437+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:45:58.438+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:45:58.442+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:45:58.442+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:45:58.442+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:45:58.443+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:45:58.443+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:45:58.444+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:46:01.432+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:46:01.432+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:46:01.432+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:46:01.432+05:30 level=INFO msg="[booking-controller] Verification requested: 38f04f5a-11fb-4941-8c03-42c57fc32258 → approve"
time=2025-10-30T21:46:01.433+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:46:01.437+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column \"concert_name\" does not exist"
time=2025-10-30T21:46:01.440+05:30 level=ERROR msg="[booking-controller] Approval failed for 38f04f5a-11fb-4941-8c03-42c57fc32258: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:47:25.431+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:47:25.435+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:47:25.438+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 69a0b445-c3d5-4e23-bad1-e8f92f064bcf"
time=2025-10-30T21:47:25.448+05:30 level=INFO msg="[get-seat-uc] Seat 69a0b445-c3d5-4e23-bad1-e8f92f064bcf successfully locked for update. Current Available: 99"
time=2025-10-30T21:47:25.449+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 69a0b445-c3d5-4e23-bad1-e8f92f064bcf. New count: 98"
time=2025-10-30T21:47:25.454+05:30 level=INFO msg="[update-seat-uc] Seat 69a0b445-c3d5-4e23-bad1-e8f92f064bcf availability updated to 98 within transaction."
time=2025-10-30T21:47:25.456+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:47:25.456+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: 05f2ca34-68f7-44a5-8151-c1b0faf885c7 for Name: newone"
time=2025-10-30T21:47:25.464+05:30 level=INFO msg="[create-participant-uc] Participant 05f2ca34-68f7-44a5-8151-c1b0faf885c7 inserted successfully within transaction."
time=2025-10-30T21:47:25.483+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:25.485+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T21:47:27.603+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:47:27.603+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:47:27.605+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:47:27.606+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:47:27.609+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 4 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:47:27.610+05:30 level=INFO msg="[booking] Successfully retrieved 4 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:47:31.084+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T21:47:31.086+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:31.767+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:47:31.785+05:30 level=INFO msg="[booking] Fetching receipt for bookingID: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:31.792+05:30 level=INFO msg="[get-booking-receipt-uc] Fetching booking receipt for BookingID: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:31.822+05:30 level=INFO msg="[get-booking-receipt-uc] Booking receipt successfully retrieved for dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:31.836+05:30 level=INFO msg="[booking] Booking receipt fetched successfully for dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:37.019+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:47:37.019+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:47:37.019+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:47:37.020+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:47:37.020+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:47:37.022+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 2 pending bookings."
time=2025-10-30T21:47:37.025+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:47:37.025+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:47:37.025+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:47:37.026+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:47:37.026+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:47:37.027+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 2 pending bookings."
time=2025-10-30T21:47:45.893+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:47:45.894+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:47:45.895+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:47:45.895+05:30 level=INFO msg="[booking-controller] Verification requested: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80 → approve"
time=2025-10-30T21:47:45.896+05:30 level=INFO msg="[approve-booking-uc] Approving booking: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:47:45.901+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column \"concert_name\" does not exist"
time=2025-10-30T21:47:45.905+05:30 level=ERROR msg="[booking-controller] Approval failed for dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:47:50.863+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:47:50.863+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:47:50.864+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:47:50.865+05:30 level=INFO msg="[booking-controller] Verification requested: 38f04f5a-11fb-4941-8c03-42c57fc32258 → approve"
time=2025-10-30T21:47:50.866+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:47:50.870+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: column \"concert_name\" does not exist"
time=2025-10-30T21:47:50.875+05:30 level=ERROR msg="[booking-controller] Approval failed for 38f04f5a-11fb-4941-8c03-42c57fc32258: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:49:28.073+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:49:28.076+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:49:28.077+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:49:28.078+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:49:28.078+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:49:28.078+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:49:28.364+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:49:28.364+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:49:28.364+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:49:28.364+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:49:28.364+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:49:28.366+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:49:28.366+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:49:28.366+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:49:28.366+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:49:28.366+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:49:28.366+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:49:28.367+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:49:28.367+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:49:28.367+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:49:28.367+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:49:28.368+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:49:28.368+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:49:28.369+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:49:28.370+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:49:28.370+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:49:28.370+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:49:28.370+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:49:28.371+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:49:28.372+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:49:28.372+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:49:28.372+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:49:28.373+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:49:28.374+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:50:19.782+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:50:19.782+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:50:19.783+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:50:19.784+05:30 level=INFO msg="[booking-controller] Verification requested: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80 → approve"
time=2025-10-30T21:50:19.785+05:30 level=INFO msg="[approve-booking-uc] Approving booking: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:50:19.805+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: invalid input syntax for type uuid: \"\""
time=2025-10-30T21:50:19.809+05:30 level=ERROR msg="[booking-controller] Approval failed for dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:50:24.049+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:50:24.049+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:50:24.050+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:50:24.050+05:30 level=INFO msg="[booking-controller] Verification requested: 38f04f5a-11fb-4941-8c03-42c57fc32258 → approve"
time=2025-10-30T21:50:24.050+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 38f04f5a-11fb-4941-8c03-42c57fc32258"
time=2025-10-30T21:50:24.052+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: invalid input syntax for type uuid: \"\""
time=2025-10-30T21:50:24.052+05:30 level=ERROR msg="[booking-controller] Approval failed for 38f04f5a-11fb-4941-8c03-42c57fc32258: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:50:26.627+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:50:26.628+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:50:26.628+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:50:26.628+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:50:26.628+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:50:26.632+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 2 pending bookings."
time=2025-10-30T21:50:26.638+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:50:26.639+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:50:26.639+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:50:26.640+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:50:26.640+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:50:26.642+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 2 pending bookings."
time=2025-10-30T21:50:29.116+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:50:29.117+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:50:29.117+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:50:29.118+05:30 level=INFO msg="[booking-controller] Verification requested: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80 → approve"
time=2025-10-30T21:50:29.120+05:30 level=INFO msg="[approve-booking-uc] Approving booking: dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80"
time=2025-10-30T21:50:29.129+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: invalid input syntax for type uuid: \"\""
time=2025-10-30T21:50:29.133+05:30 level=ERROR msg="[booking-controller] Approval failed for dda91cd8-ff6f-4e53-a6ee-5a9e321c1e80: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:52:23.525+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:23.526+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:52:23.526+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:52:23.528+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:23.528+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:23.529+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:52:23.529+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:52:23.528+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:52:23.530+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:52:23.530+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:52:23.533+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:23.533+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:52:23.533+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:52:23.534+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:52:23.537+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:23.538+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:52:23.538+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:52:23.539+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:52:23.801+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:52:23.847+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:52:23.850+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:23.850+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:52:23.850+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:52:23.851+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:52:25.750+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:25.750+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:52:25.751+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:52:25.752+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:52:25.765+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 0 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:52:25.766+05:30 level=INFO msg="[booking] Successfully retrieved 0 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:52:47.841+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:52:47.844+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:52:47.846+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 14c7770d-c354-4df9-85e1-9c1757a8acbc"
time=2025-10-30T21:52:47.850+05:30 level=INFO msg="[get-seat-uc] Seat 14c7770d-c354-4df9-85e1-9c1757a8acbc successfully locked for update. Current Available: 99"
time=2025-10-30T21:52:47.851+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 14c7770d-c354-4df9-85e1-9c1757a8acbc. New count: 98"
time=2025-10-30T21:52:47.855+05:30 level=INFO msg="[update-seat-uc] Seat 14c7770d-c354-4df9-85e1-9c1757a8acbc availability updated to 98 within transaction."
time=2025-10-30T21:52:47.856+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:52:47.856+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: d3931a50-2ac5-4e58-975a-ab8cd92a9be4 for Name: Kalai"
time=2025-10-30T21:52:47.861+05:30 level=INFO msg="[create-participant-uc] Participant d3931a50-2ac5-4e58-975a-ab8cd92a9be4 inserted successfully within transaction."
time=2025-10-30T21:52:47.886+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: e7c58a8b-0fee-46ba-acf6-7948c4e1b700"
time=2025-10-30T21:52:47.887+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T21:52:50.385+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T21:52:50.385+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: e7c58a8b-0fee-46ba-acf6-7948c4e1b700"
time=2025-10-30T21:52:53.574+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:52:53.574+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:52:53.574+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:52:53.574+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:52:53.575+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:52:53.576+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:52:53.580+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:52:53.580+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:52:53.580+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:52:53.580+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:52:53.581+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:52:53.582+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:52:54.639+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:52:54.639+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T21:52:54.640+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:52:54.641+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T21:52:54.642+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T21:52:54.646+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 1 total bookings for admin."
time=2025-10-30T21:52:55.913+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:52:55.913+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:52:55.914+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:52:55.915+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:52:55.915+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:52:55.917+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:52:56.814+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:52:56.815+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T21:52:56.815+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:52:56.817+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T21:52:56.817+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T21:52:56.821+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 1 total bookings for admin."
time=2025-10-30T21:52:57.698+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:52:57.700+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:52:57.700+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:52:57.703+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:52:57.704+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:52:57.708+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:53:01.269+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:53:01.270+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:53:01.273+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:53:01.276+05:30 level=INFO msg="[booking-controller] Verification requested: e7c58a8b-0fee-46ba-acf6-7948c4e1b700 → approve"
time=2025-10-30T21:53:01.276+05:30 level=INFO msg="[approve-booking-uc] Approving booking: e7c58a8b-0fee-46ba-acf6-7948c4e1b700"
time=2025-10-30T21:53:01.284+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: invalid input syntax for type uuid: \"\""
time=2025-10-30T21:53:01.289+05:30 level=ERROR msg="[booking-controller] Approval failed for e7c58a8b-0fee-46ba-acf6-7948c4e1b700: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:55:54.557+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:55:54.559+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:55:54.559+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:55:54.559+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:55:54.559+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:55:54.559+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:55:54.749+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:55:54.749+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:55:54.749+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:55:54.750+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:55:54.751+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:55:54.752+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:55:54.752+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:55:54.753+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:55:54.754+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:55:54.755+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:55:54.755+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:55:54.756+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:55:54.757+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:55:54.758+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:55:54.758+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:55:54.759+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:55:54.759+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:55:54.760+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:55:54.761+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:55:54.761+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:55:54.761+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:55:54.762+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:55:54.762+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:55:54.764+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:55:54.764+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:55:54.765+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:55:54.765+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:55:54.766+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:56:04.977+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:56:04.978+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:56:04.979+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:56:04.980+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:56:04.980+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:56:04.991+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:56:05.001+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:56:05.001+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T21:56:05.002+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:56:05.003+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T21:56:05.009+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T21:56:05.015+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T21:56:06.767+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T21:56:06.767+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T21:56:06.768+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T21:56:06.768+05:30 level=INFO msg="[booking-controller] Verification requested: e7c58a8b-0fee-46ba-acf6-7948c4e1b700 → approve"
time=2025-10-30T21:56:06.768+05:30 level=INFO msg="[approve-booking-uc] Approving booking: e7c58a8b-0fee-46ba-acf6-7948c4e1b700"
time=2025-10-30T21:56:06.772+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: sql: no rows in result set"
time=2025-10-30T21:56:06.778+05:30 level=ERROR msg="[booking-controller] Approval failed for e7c58a8b-0fee-46ba-acf6-7948c4e1b700: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T21:59:02.722+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T21:59:02.725+05:30 level=INFO msg="[main] program started"
time=2025-10-30T21:59:02.725+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T21:59:02.725+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T21:59:02.725+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T21:59:02.725+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T21:59:02.866+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T21:59:02.866+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T21:59:02.866+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T21:59:02.866+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T21:59:02.866+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T21:59:02.868+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T21:59:02.868+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T21:59:02.868+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T21:59:02.868+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T21:59:02.868+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T21:59:02.869+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T21:59:02.869+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T21:59:02.869+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T21:59:02.870+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T21:59:02.870+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T21:59:02.871+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T21:59:02.871+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T21:59:02.871+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T21:59:02.871+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T21:59:02.871+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T21:59:02.872+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T21:59:02.872+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T21:59:02.873+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T21:59:02.873+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T21:59:02.873+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T21:59:02.873+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T21:59:02.873+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T21:59:02.874+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T21:59:22.151+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:22.151+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:22.151+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:22.152+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:59:22.151+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:59:22.152+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:59:22.152+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:59:22.153+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:59:22.153+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:59:22.158+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:59:22.169+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:22.173+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T21:59:22.173+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T21:59:22.177+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T21:59:22.470+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:59:22.472+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:22.472+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T21:59:22.472+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T21:59:22.473+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T21:59:22.509+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:59:22.514+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:22.514+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T21:59:22.515+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T21:59:22.517+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T21:59:23.142+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:23.142+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:59:23.143+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:59:23.145+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:59:23.156+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 0 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:59:23.157+05:30 level=INFO msg="[booking] Successfully retrieved 0 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T21:59:42.428+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:42.430+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T21:59:42.431+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 6d909559-7054-47dc-8bd1-e8b566a82bbb"
time=2025-10-30T21:59:42.439+05:30 level=INFO msg="[get-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb successfully locked for update. Current Available: 99"
time=2025-10-30T21:59:42.441+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 6d909559-7054-47dc-8bd1-e8b566a82bbb. New count: 98"
time=2025-10-30T21:59:42.447+05:30 level=INFO msg="[update-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb availability updated to 98 within transaction."
time=2025-10-30T21:59:42.447+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T21:59:42.448+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: db57a541-4c12-4def-9c4b-5ad66e09f0a3 for Name: Kalai"
time=2025-10-30T21:59:42.454+05:30 level=INFO msg="[create-participant-uc] Participant db57a541-4c12-4def-9c4b-5ad66e09f0a3 inserted successfully within transaction."
time=2025-10-30T21:59:42.487+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: 85a043f0-063c-43b0-8c92-9c4251d0e645"
time=2025-10-30T21:59:42.489+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T21:59:44.604+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T21:59:44.605+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: 85a043f0-063c-43b0-8c92-9c4251d0e645"
time=2025-10-30T21:59:45.614+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T21:59:45.615+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:59:45.615+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T21:59:45.616+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T21:59:45.619+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T21:59:45.619+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:00:04.367+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:00:04.368+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:00:04.368+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:00:04.368+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:00:04.368+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:00:04.369+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:00:04.370+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:00:04.370+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:00:04.371+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:00:04.371+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:00:04.371+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:00:04.373+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:00:05.486+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:00:05.486+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T22:00:05.489+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:00:05.493+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T22:00:05.494+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T22:00:05.497+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 1 total bookings for admin."
time=2025-10-30T22:00:06.803+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:00:06.806+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:00:06.807+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:00:06.809+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:00:06.809+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:00:06.811+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:00:08.876+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:00:08.878+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:00:08.879+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:00:08.880+05:30 level=INFO msg="[booking-controller] Verification requested: 85a043f0-063c-43b0-8c92-9c4251d0e645 → approve"
time=2025-10-30T22:00:08.880+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 85a043f0-063c-43b0-8c92-9c4251d0e645"
time=2025-10-30T22:00:08.887+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: sql: no rows in result set"
time=2025-10-30T22:00:08.893+05:30 level=ERROR msg="[booking-controller] Approval failed for 85a043f0-063c-43b0-8c92-9c4251d0e645: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:08:30.211+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:08:30.212+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:08:30.212+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:08:30.212+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:08:30.212+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:08:30.213+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:08:30.424+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:08:30.424+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:08:30.425+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:08:30.425+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:08:30.425+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:08:30.426+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:08:30.427+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:08:30.428+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:08:30.428+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:08:30.429+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:08:30.429+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:08:30.430+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:08:30.431+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:08:30.432+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:08:30.432+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:08:30.433+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:08:30.433+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:08:30.435+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:08:30.435+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:08:30.436+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:08:30.436+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:08:30.437+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:08:30.437+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:08:30.438+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:08:30.439+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:08:30.439+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:08:30.440+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:08:30.440+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:08:40.007+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:40.007+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:40.008+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:08:40.007+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:40.008+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:08:40.009+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:08:40.009+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:08:40.009+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:08:40.008+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:08:40.013+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:08:40.020+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:40.020+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:08:40.021+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:08:40.026+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:08:40.387+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:08:40.393+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:40.393+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:08:40.393+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:08:40.394+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:08:40.482+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:08:40.486+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:40.486+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:08:40.486+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:08:40.487+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:08:42.226+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:08:42.227+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:08:42.228+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:08:42.229+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T22:08:42.237+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T22:08:42.238+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:08:47.399+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:08:47.400+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:08:47.401+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:08:47.402+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:08:47.402+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:08:47.404+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:08:47.408+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:08:47.409+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:08:47.410+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:08:47.410+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:08:47.410+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:08:47.412+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:08:49.234+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:08:49.234+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:08:49.234+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:08:49.235+05:30 level=INFO msg="[booking-controller] Verification requested: 85a043f0-063c-43b0-8c92-9c4251d0e645 → approve"
time=2025-10-30T22:08:49.236+05:30 level=INFO msg="[approve-booking-uc] Approving booking: 85a043f0-063c-43b0-8c92-9c4251d0e645"
time=2025-10-30T22:08:49.244+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: sql: no rows in result set"
time=2025-10-30T22:08:49.247+05:30 level=ERROR msg="[booking-controller] Approval failed for 85a043f0-063c-43b0-8c92-9c4251d0e645: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:10:16.652+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:16.653+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:10:16.655+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:10:16.655+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:10:16.656+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:10:16.664+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T22:10:16.676+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:16.680+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:10:16.681+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:10:16.683+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:10:16.687+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:10:16.689+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T22:10:18.025+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:18.026+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:10:18.029+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:10:18.031+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:10:18.042+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:18.043+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:10:18.045+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:10:18.048+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:10:22.980+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:22.981+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:10:22.981+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:10:22.982+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:10:22.982+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:10:22.983+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:10:22.983+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:22.984+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:10:22.984+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:10:22.985+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:22.987+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:10:22.988+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:10:22.985+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:22.987+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:10:22.989+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:10:22.990+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:10:22.991+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:10:22.995+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:10:24.215+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:10:24.215+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:10:24.215+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:10:24.216+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T22:10:24.227+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 0 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T22:10:24.227+05:30 level=INFO msg="[booking] Successfully retrieved 0 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:10:29.665+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:29.669+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:10:29.667+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:29.669+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:10:29.670+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:10:29.669+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:10:29.673+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:10:29.677+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:10:29.680+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:29.682+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:10:29.687+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:10:29.685+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:29.688+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:10:29.688+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:10:29.688+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:10:29.694+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:10:44.063+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:10:44.063+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/concerts. Required role: Admin. User role: admin"
time=2025-10-30T22:10:44.064+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:10:44.065+05:30 level=INFO msg="[create-concert-uc] Starting concert creation process."
time=2025-10-30T22:10:44.065+05:30 level=INFO msg="[create-concert-uc] Generated new ConcertID: ef281467-8127-4869-a1d8-f63df2fd748e for title: adfasf"
time=2025-10-30T22:10:44.065+05:30 level=INFO msg="[create-concert-uc] Marshaling 3 SeatIDs for storage."
time=2025-10-30T22:10:44.066+05:30 level=INFO msg="[create-concert-uc] Marshaling 2 PaymentIDs for storage."
time=2025-10-30T22:10:44.067+05:30 level=INFO msg="[create-concert-uc] Inserting new concert record into database for ID: ef281467-8127-4869-a1d8-f63df2fd748e"
time=2025-10-30T22:10:44.070+05:30 level=INFO msg="[create-concert-uc] Concert ef281467-8127-4869-a1d8-f63df2fd748e created successfully. Venue: adsfadfa"
time=2025-10-30T22:11:11.422+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:11.422+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:11:11.424+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:11:11.424+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:11:11.432+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:11.432+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:11:11.432+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:11:11.433+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:11:18.047+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:18.047+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:11:18.047+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:11:18.048+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:18.048+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:11:18.048+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:11:18.048+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:18.049+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:11:18.049+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:11:18.048+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:11:18.049+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:11:18.049+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:11:18.051+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:18.051+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:11:18.051+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:11:18.052+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:18.052+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:11:18.052+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:11:18.052+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:18.053+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:11:18.053+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:11:18.054+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:11:18.052+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:11:18.055+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:11:32.277+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:32.279+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T22:11:32.281+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 6d909559-7054-47dc-8bd1-e8b566a82bbb"
time=2025-10-30T22:11:32.285+05:30 level=INFO msg="[get-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb successfully locked for update. Current Available: 98"
time=2025-10-30T22:11:32.286+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 6d909559-7054-47dc-8bd1-e8b566a82bbb. New count: 97"
time=2025-10-30T22:11:32.292+05:30 level=INFO msg="[update-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb availability updated to 97 within transaction."
time=2025-10-30T22:11:32.292+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T22:11:32.294+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: b61dab4c-0b9f-4a13-b552-7a0e3bf990f8 for Name: aefdsfadsf"
time=2025-10-30T22:11:32.300+05:30 level=INFO msg="[create-participant-uc] Participant b61dab4c-0b9f-4a13-b552-7a0e3bf990f8 inserted successfully within transaction."
time=2025-10-30T22:11:32.331+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: b9231fe5-07c2-4192-a275-80d390eb2b99"
time=2025-10-30T22:11:32.332+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T22:11:33.815+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:11:33.815+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:11:33.816+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:11:33.817+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T22:11:33.821+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T22:11:33.822+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:11:34.303+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T22:11:34.305+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: b9231fe5-07c2-4192-a275-80d390eb2b99"
time=2025-10-30T22:11:37.556+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:37.557+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:11:37.557+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:11:37.558+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:11:37.558+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:11:37.560+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:11:37.565+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:37.565+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:11:37.565+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:11:37.565+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:11:37.566+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:11:37.570+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:11:39.632+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:39.633+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings. Required role: Admin. User role: admin"
time=2025-10-30T22:11:39.634+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:11:39.635+05:30 level=INFO msg="[booking-controller] Fetching all bookings (Admin)"
time=2025-10-30T22:11:39.636+05:30 level=INFO msg="[get-all-bookings-admin-uc] Fetching all bookings for admin view."
time=2025-10-30T22:11:39.639+05:30 level=INFO msg="[get-all-bookings-admin-uc] Retrieved 1 total bookings for admin."
time=2025-10-30T22:11:40.410+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:40.411+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:11:40.411+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:11:40.412+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:11:40.413+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:11:40.415+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:11:42.614+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:11:42.614+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:11:42.616+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:11:42.617+05:30 level=INFO msg="[booking-controller] Verification requested: b9231fe5-07c2-4192-a275-80d390eb2b99 → approve"
time=2025-10-30T22:11:42.618+05:30 level=INFO msg="[approve-booking-uc] Approving booking: b9231fe5-07c2-4192-a275-80d390eb2b99"
time=2025-10-30T22:11:42.625+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: sql: no rows in result set"
time=2025-10-30T22:11:42.631+05:30 level=ERROR msg="[booking-controller] Approval failed for b9231fe5-07c2-4192-a275-80d390eb2b99: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:20:33.507+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:20:33.509+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:20:33.509+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:20:33.509+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:20:33.509+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:20:33.509+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:20:33.647+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:20:33.647+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:20:33.648+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:20:33.648+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:20:33.648+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:20:33.649+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:20:33.649+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:20:33.649+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:20:33.649+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:20:33.649+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:20:33.649+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:20:33.650+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:20:33.650+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:20:33.651+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:20:33.652+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:20:33.652+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:20:45.602+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:20:45.602+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:20:45.602+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:20:45.602+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:20:45.603+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:20:45.608+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:20:45.611+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:20:45.612+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:20:45.612+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:20:45.612+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:20:45.613+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:20:45.614+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:20:48.347+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:20:48.349+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:20:48.349+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:20:48.350+05:30 level=INFO msg="[booking-controller] Verification requested: b9231fe5-07c2-4192-a275-80d390eb2b99 → approve"
time=2025-10-30T22:20:48.351+05:30 level=INFO msg="[approve-booking-uc] Approving booking: b9231fe5-07c2-4192-a275-80d390eb2b99"
time=2025-10-30T22:20:48.362+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: invalid input syntax for type uuid: \"\""
time=2025-10-30T22:20:48.366+05:30 level=ERROR msg="[booking-controller] Approval failed for b9231fe5-07c2-4192-a275-80d390eb2b99: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:21:20.422+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:20.423+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:21:20.423+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:21:20.423+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:21:20.424+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:21:20.429+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T22:21:20.433+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:20.433+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:21:20.433+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:21:20.434+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:21:20.434+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:21:20.436+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T22:21:21.448+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:21.451+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:21:21.452+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:21:21.455+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:21:21.457+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:21.459+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:21:21.460+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:21:21.462+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:21:22.985+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:22.986+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:21:22.987+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:21:22.987+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:22.988+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:21:22.992+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:21:22.993+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:21:23.001+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:21:23.005+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:23.005+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:21:23.006+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:21:23.008+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:23.012+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:21:23.008+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:21:23.013+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:21:23.017+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:21:33.875+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:33.878+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/concerts. Required role: Admin. User role: admin"
time=2025-10-30T22:21:33.879+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:21:33.879+05:30 level=INFO msg="[create-concert-uc] Starting concert creation process."
time=2025-10-30T22:21:33.879+05:30 level=INFO msg="[create-concert-uc] Generated new ConcertID: 7d666b8d-59f1-45a9-a701-151f340d0c9e for title: fadfsdf"
time=2025-10-30T22:21:33.879+05:30 level=INFO msg="[create-concert-uc] Marshaling 3 SeatIDs for storage."
time=2025-10-30T22:21:33.881+05:30 level=INFO msg="[create-concert-uc] Marshaling 3 PaymentIDs for storage."
time=2025-10-30T22:21:33.882+05:30 level=INFO msg="[create-concert-uc] Inserting new concert record into database for ID: 7d666b8d-59f1-45a9-a701-151f340d0c9e"
time=2025-10-30T22:21:33.893+05:30 level=INFO msg="[create-concert-uc] Concert 7d666b8d-59f1-45a9-a701-151f340d0c9e created successfully. Venue: adfads"
time=2025-10-30T22:21:37.290+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:37.290+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:21:37.290+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:21:37.291+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:21:37.292+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:21:37.293+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T22:21:37.299+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:21:37.300+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:21:37.301+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:21:37.301+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:21:37.302+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:21:37.304+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
time=2025-10-30T22:21:47.138+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:21:47.139+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:21:47.139+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:21:47.139+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T22:21:47.141+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 0 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T22:21:47.141+05:30 level=INFO msg="[booking] Successfully retrieved 0 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:22:04.038+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:22:04.043+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T22:22:04.046+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 14c7770d-c354-4df9-85e1-9c1757a8acbc"
time=2025-10-30T22:22:04.049+05:30 level=INFO msg="[get-seat-uc] Seat 14c7770d-c354-4df9-85e1-9c1757a8acbc successfully locked for update. Current Available: 98"
time=2025-10-30T22:22:04.049+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 14c7770d-c354-4df9-85e1-9c1757a8acbc. New count: 97"
time=2025-10-30T22:22:04.053+05:30 level=INFO msg="[update-seat-uc] Seat 14c7770d-c354-4df9-85e1-9c1757a8acbc availability updated to 97 within transaction."
time=2025-10-30T22:22:04.054+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T22:22:04.055+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: ad1f8b1a-79d5-4ab4-88c0-c1542c6e2465 for Name: afdsf"
time=2025-10-30T22:22:04.061+05:30 level=INFO msg="[create-participant-uc] Participant ad1f8b1a-79d5-4ab4-88c0-c1542c6e2465 inserted successfully within transaction."
time=2025-10-30T22:22:04.086+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:22:04.088+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T22:22:06.470+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:22:06.471+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:22:06.471+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:22:06.472+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T22:22:06.474+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T22:22:06.474+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:22:06.700+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T22:22:06.701+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:22:10.396+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:22:10.396+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:22:10.396+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:22:10.398+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:22:10.404+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:22:10.405+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:22:10.405+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:22:10.406+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:22:11.080+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:22:11.081+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:22:11.081+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:22:11.082+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:22:11.082+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:22:11.085+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:22:11.088+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:22:11.088+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:22:11.088+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:22:11.089+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:22:11.090+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:22:11.094+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:22:13.801+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:22:13.801+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:22:13.801+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:22:13.801+05:30 level=INFO msg="[booking-controller] Verification requested: f7709033-360c-48a2-8344-ed35fdab19a2 → approve"
time=2025-10-30T22:22:13.803+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:22:13.804+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: pq: invalid input syntax for type uuid: \"\""
time=2025-10-30T22:22:13.805+05:30 level=ERROR msg="[booking-controller] Approval failed for f7709033-360c-48a2-8344-ed35fdab19a2: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:24:48.582+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:24:48.584+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:24:48.584+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:24:48.584+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:24:48.584+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:24:48.584+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:24:48.763+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:24:48.763+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:24:48.764+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:24:48.764+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:24:48.764+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:24:48.764+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:24:48.765+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:24:48.765+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:24:48.765+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:24:48.765+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:24:48.765+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:24:48.766+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:24:48.766+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:24:48.766+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:24:48.766+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:24:48.766+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:24:48.766+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:24:48.767+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:24:48.767+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:24:57.019+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:24:57.019+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:24:57.019+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:24:57.019+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:24:57.019+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:24:57.023+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:24:57.024+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:24:57.023+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:24:57.024+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:24:57.026+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:24:57.028+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:24:57.031+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:24:57.031+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:24:57.033+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:24:57.033+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:24:57.034+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:24:57.034+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:24:57.034+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:24:57.035+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:24:57.351+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:24:57.354+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:24:57.354+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:24:57.354+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:24:57.355+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:25:02.908+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:25:02.908+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:25:02.909+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:25:02.909+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:25:02.910+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:25:02.915+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:25:02.919+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:25:02.919+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:25:02.920+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:25:02.920+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:25:02.920+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:25:02.922+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:25:06.562+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:25:06.563+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:25:06.564+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:25:06.565+05:30 level=INFO msg="[booking-controller] Verification requested: f7709033-360c-48a2-8344-ed35fdab19a2 → approve"
time=2025-10-30T22:25:06.565+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:25:06.571+05:30 level=ERROR msg="[booking-controller] Approval failed for f7709033-360c-48a2-8344-ed35fdab19a2: invalid concert ID format: invalid UUID length: 0"
time=2025-10-30T22:32:33.256+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:32:33.258+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:32:33.258+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:32:33.258+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:32:33.258+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:32:33.258+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:32:33.375+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:32:33.375+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:32:33.375+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:32:33.376+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:32:33.376+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:32:33.377+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:32:33.377+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:32:33.377+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:32:33.378+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:32:33.378+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:32:33.378+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:32:33.379+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:32:33.379+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:32:33.380+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:32:33.380+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:32:33.382+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:32:33.382+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:32:33.382+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:32:33.382+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:32:33.383+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:32:33.383+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:32:33.384+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:32:33.384+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:32:33.384+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:32:33.385+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:32:33.385+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:32:33.386+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:32:33.387+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:33:07.676+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:33:07.677+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:33:07.678+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:33:07.686+05:30 level=INFO msg="[booking-controller] Verification requested: f7709033-360c-48a2-8344-ed35fdab19a2 → approve"
time=2025-10-30T22:33:07.688+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:33:07.750+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:33:07.782+05:30 level=INFO msg="[approve-booking-uc] 🎟️ Raw ConcertID (type: string): "
time=2025-10-30T22:33:07.801+05:30 level=ERROR msg="[approve-booking-uc] ❌ Invalid concert_id format: value=, type=string, error=invalid UUID length: 0"
time=2025-10-30T22:33:07.805+05:30 level=ERROR msg="[booking-controller] Approval failed for f7709033-360c-48a2-8344-ed35fdab19a2: invalid concert ID format: invalid UUID length: 0"
time=2025-10-30T22:36:10.734+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:36:10.736+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:36:10.736+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:36:10.737+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:36:10.737+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:36:10.737+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:36:11.053+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:36:11.053+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:36:11.053+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:36:11.053+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:36:11.053+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:36:11.054+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:36:11.054+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:36:11.054+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:36:11.054+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:36:11.055+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:36:11.055+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:36:11.055+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:36:11.055+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:36:11.055+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:36:11.055+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:36:11.056+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:36:11.056+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:36:11.056+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:36:11.056+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:36:11.056+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:36:11.056+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:36:11.057+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:36:11.057+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:36:11.057+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:36:11.057+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:36:11.057+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:36:11.057+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:36:11.057+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:36:26.116+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:36:26.119+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:36:26.120+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:36:26.121+05:30 level=INFO msg="[booking-controller] Verification requested: f7709033-360c-48a2-8344-ed35fdab19a2 → approve"
time=2025-10-30T22:36:26.122+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:36:26.141+05:30 level=INFO msg="[approve-booking-uc] 🎟️ Raw ConcertID (type: string): ef281467-8127-4869-a1d8-f63df2fd748e"
time=2025-10-30T22:36:26.155+05:30 level=INFO msg="[approve-booking-uc] ✅ Parsed Concert UUID (type: uuid.UUID): ef281467-8127-4869-a1d8-f63df2fd748e"
time=2025-10-30T22:36:26.232+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: sql: no rows in result set"
time=2025-10-30T22:36:26.237+05:30 level=ERROR msg="[booking-controller] Approval failed for f7709033-360c-48a2-8344-ed35fdab19a2: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:39:57.961+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:39:57.962+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:39:57.962+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:39:57.962+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:39:57.963+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:39:57.963+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:39:58.200+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:39:58.200+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:39:58.200+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:39:58.200+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:39:58.200+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:39:58.202+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:39:58.202+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:39:58.202+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:39:58.202+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:39:58.202+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:39:58.202+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:39:58.203+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:39:58.204+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:39:58.204+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:40:12.267+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:40:12.281+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:40:12.287+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:40:12.300+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:40:12.380+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:40:12.394+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:40:12.443+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:40:12.481+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:40:12.519+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:40:12.528+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:40:12.562+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:40:12.621+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:40:14.708+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:40:14.710+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:40:14.718+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:40:14.719+05:30 level=INFO msg="[booking-controller] Verification requested: f7709033-360c-48a2-8344-ed35fdab19a2 → approve"
time=2025-10-30T22:40:14.748+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f7709033-360c-48a2-8344-ed35fdab19a2"
time=2025-10-30T22:40:14.805+05:30 level=INFO msg="[get-concert-uc] Starting retrieval for concert ID: ef281467-8127-4869-a1d8-f63df2fd748e"
time=2025-10-30T22:40:14.821+05:30 level=INFO msg="[get-concert-uc] Executing SELECT query for ID: ef281467-8127-4869-a1d8-f63df2fd748e"
time=2025-10-30T22:40:15.038+05:30 level=WARN msg="[get-concert-uc] Retrieval failed for ef281467-8127-4869-a1d8-f63df2fd748e: Not found in database."
time=2025-10-30T22:40:15.038+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Could not fetch concert details: concert with ID ef281467-8127-4869-a1d8-f63df2fd748e not found"
time=2025-10-30T22:40:15.039+05:30 level=ERROR msg="[booking-controller] Approval failed for f7709033-360c-48a2-8344-ed35fdab19a2: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:41:09.646+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:09.673+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:41:09.687+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:41:09.693+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:41:09.717+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:09.717+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:41:09.722+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:41:09.725+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 0 concerts."
time=2025-10-30T22:41:11.614+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:11.643+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:41:11.639+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:11.647+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:41:11.653+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:41:11.703+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:41:11.701+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:41:11.746+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:41:11.772+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:11.775+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:41:11.774+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:11.778+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:41:11.780+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:41:11.778+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:41:11.782+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:41:11.784+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:41:23.425+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:23.425+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/concerts. Required role: Admin. User role: admin"
time=2025-10-30T22:41:23.427+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:41:23.427+05:30 level=INFO msg="[create-concert-uc] Starting concert creation process."
time=2025-10-30T22:41:23.428+05:30 level=INFO msg="[create-concert-uc] Generated new ConcertID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0 for title: adsa"
time=2025-10-30T22:41:23.434+05:30 level=INFO msg="[create-concert-uc] Marshaling 3 SeatIDs for storage."
time=2025-10-30T22:41:23.437+05:30 level=INFO msg="[create-concert-uc] Marshaling 3 PaymentIDs for storage."
time=2025-10-30T22:41:23.440+05:30 level=INFO msg="[create-concert-uc] Inserting new concert record into database for ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:41:23.444+05:30 level=INFO msg="[create-concert-uc] Concert 459f268a-7396-4eb4-bcd3-bc4ecc3914c0 created successfully. Venue: fadfasdf"
time=2025-10-30T22:41:26.932+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:26.947+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:41:26.990+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:41:27.008+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:41:27.021+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:41:27.028+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:41:27.036+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:41:27.046+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:41:47.719+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:41:47.822+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:41:47.782+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:41:47.808+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:41:47.848+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:41:47.906+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:41:47.942+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:41:47.950+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:41:47.951+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:41:47.952+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:41:47.961+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:41:47.968+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:41:48.014+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:41:48.106+05:30 level=INFO msg="[get-all-payment-details-uc] Starting retrieval of all payment records."
time=2025-10-30T22:41:48.125+05:30 level=INFO msg="[get-all-payment-details-uc] Executing SELECT all query."
time=2025-10-30T22:41:48.131+05:30 level=INFO msg="[get-all-payment-details-uc] Successfully retrieved 3 payment records."
time=2025-10-30T22:41:48.153+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:41:48.256+05:30 level=INFO msg="[get-all-concert-uc] Starting retrieval of all concerts."
time=2025-10-30T22:41:48.286+05:30 level=INFO msg="[get-all-concert-uc] Executing SELECT all query."
time=2025-10-30T22:41:48.272+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:41:48.298+05:30 level=INFO msg="[get-all-seat-uc] Starting retrieval of all seat records."
time=2025-10-30T22:41:48.302+05:30 level=INFO msg="[get-all-seat-uc] Executing SELECT all query."
time=2025-10-30T22:41:48.298+05:30 level=INFO msg="[get-all-concert-uc] Successfully retrieved 1 concerts."
time=2025-10-30T22:41:48.362+05:30 level=INFO msg="[get-all-seat-uc] Successfully retrieved 3 seat records."
time=2025-10-30T22:42:04.465+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:42:04.495+05:30 level=INFO msg="[create-booking-uc] 🟢 Starting booking process"
time=2025-10-30T22:42:04.507+05:30 level=INFO msg="[get-seat-uc] Starting transactional lock (FOR UPDATE) for SeatID: 6d909559-7054-47dc-8bd1-e8b566a82bbb"
time=2025-10-30T22:42:04.511+05:30 level=INFO msg="[get-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb successfully locked for update. Current Available: 97"
time=2025-10-30T22:42:04.515+05:30 level=INFO msg="[update-seat-uc] Starting transactional availability update for ID: 6d909559-7054-47dc-8bd1-e8b566a82bbb. New count: 96"
time=2025-10-30T22:42:04.518+05:30 level=INFO msg="[update-seat-uc] Seat 6d909559-7054-47dc-8bd1-e8b566a82bbb availability updated to 96 within transaction."
time=2025-10-30T22:42:04.520+05:30 level=INFO msg="[create-participant-uc] Starting transactional participant creation."
time=2025-10-30T22:42:04.523+05:30 level=INFO msg="[create-participant-uc] Generated Transactional UserID: 3b7d297b-7393-4515-b7b7-af34dc44ab57 for Name: adsfa"
time=2025-10-30T22:42:04.524+05:30 level=INFO msg="[create-participant-uc] Participant 3b7d297b-7393-4515-b7b7-af34dc44ab57 inserted successfully within transaction."
time=2025-10-30T22:42:04.545+05:30 level=INFO msg="[create-booking-uc] ✅ Booking committed successfully: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T22:42:04.566+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin email: selvanunofficial@gmail.com"
time=2025-10-30T22:42:06.617+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 5d9b57e4-bcd9-4df2-9aa9-08b18e59307c, Role: user"
time=2025-10-30T22:42:06.657+05:30 level=INFO msg="[booking] Fetching booking history for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:42:06.683+05:30 level=INFO msg="[get-all-booking-uc] Retrieving bookings for user: kalaiselvan7834@gmail.com"
time=2025-10-30T22:42:06.689+05:30 level=INFO msg="[get-all-booking-uc] Executing SELECT all query (filtered)."
time=2025-10-30T22:42:06.719+05:30 level=INFO msg="[get-all-booking-uc] Successfully retrieved 1 booking records for kalaiselvan7834@gmail.com."
time=2025-10-30T22:42:06.755+05:30 level=INFO msg="[booking] Successfully retrieved 1 bookings for kalaiselvan7834@gmail.com."
time=2025-10-30T22:42:07.529+05:30 level=INFO msg="[auth] ✅ Email sent to selvanunofficial@gmail.com via Resend."
time=2025-10-30T22:42:07.543+05:30 level=INFO msg="[create-booking-uc] ✉️ Admin notified of new booking: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T22:42:10.548+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:42:10.554+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:42:10.562+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:42:10.568+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:42:10.571+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:42:10.573+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:42:10.579+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:42:10.607+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:42:10.632+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:42:10.663+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:42:10.687+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:42:10.710+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:42:13.022+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:42:13.034+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:42:13.038+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:42:13.041+05:30 level=INFO msg="[booking-controller] Verification requested: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2 → approve"
time=2025-10-30T22:42:13.041+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T22:42:13.043+05:30 level=INFO msg="[get-concert-uc] Starting retrieval for concert ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:42:13.045+05:30 level=INFO msg="[get-concert-uc] Executing SELECT query for ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:42:13.052+05:30 level=INFO msg="[get-concert-uc] Successfully retrieved concert: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:42:13.056+05:30 level=ERROR msg="[booking-controller] Approval failed for f07db260-9a9c-4f1e-94ff-80fe3e5b86a2: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:50:18.704+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T22:50:18.706+05:30 level=INFO msg="[main] program started"
time=2025-10-30T22:50:18.706+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T22:50:18.706+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T22:50:18.707+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T22:50:18.707+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T22:50:18.991+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T22:50:18.993+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T22:50:18.993+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T22:50:18.993+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T22:50:18.994+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T22:50:18.997+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T22:50:18.998+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T22:50:19.000+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T22:50:19.004+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T22:50:19.012+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T22:50:19.019+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T22:50:19.021+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T22:50:19.021+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T22:50:19.021+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T22:50:19.021+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T22:50:19.022+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T22:50:19.022+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T22:50:19.022+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T22:50:19.023+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T22:50:19.023+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T22:50:19.023+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T22:50:19.023+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T22:50:19.023+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T22:50:19.025+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T22:50:19.025+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T22:50:19.027+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T22:50:19.027+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T22:50:19.027+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T22:50:39.590+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:50:39.607+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:50:39.628+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:50:39.637+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:50:39.674+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:50:39.734+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:50:39.797+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:50:39.811+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T22:50:39.831+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:50:39.925+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T22:50:39.932+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T22:50:39.940+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T22:50:42.058+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T22:50:42.088+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T22:50:42.116+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T22:50:42.175+05:30 level=INFO msg="[booking-controller] Verification requested: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2 → approve"
time=2025-10-30T22:50:42.202+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T22:50:42.280+05:30 level=INFO msg="[approve-booking-uc] 🎟️ ConcertID raw value (type: string): 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:50:42.307+05:30 level=INFO msg="[get-concert-uc] Starting retrieval for concert ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:50:42.448+05:30 level=INFO msg="[get-concert-uc] Executing SELECT query for ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:50:44.284+05:30 level=INFO msg="[get-concert-uc] Successfully retrieved concert: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T22:50:44.299+05:30 level=INFO msg="[approve-booking-uc] 🎵 Concert found: adsa @ 2025-10-30T22:41, fadfasdf"
time=2025-10-30T22:50:44.310+05:30 level=WARN msg="[approve-booking-uc] ⚠️ Failed to fetch payment details: pq: relation \"payment_details\" does not exist"
time=2025-10-30T22:50:44.318+05:30 level=ERROR msg="[approve-booking-uc] ❌ Failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T22:50:44.324+05:30 level=ERROR msg="[booking-controller] Approval failed for f07db260-9a9c-4f1e-94ff-80fe3e5b86a2: failed to update booking status: pq: current transaction is aborted, commands ignored until end of transaction block"
time=2025-10-30T23:05:33.566+05:30 level=INFO msg="[auth] JWT configuration loaded and signing key initialized."
time=2025-10-30T23:05:33.567+05:30 level=INFO msg="[main] program started"
time=2025-10-30T23:05:33.567+05:30 level=INFO msg="[main] Configuring global middleware and database connection."
time=2025-10-30T23:05:33.568+05:30 level=INFO msg="[main] Attempting to connect to PostgreSQL..."
time=2025-10-30T23:05:33.568+05:30 level=INFO msg="[db] Attempting to open database connection..."
time=2025-10-30T23:05:33.568+05:30 level=INFO msg="[db] Pinging database to verify connection..."
time=2025-10-30T23:05:33.674+05:30 level=INFO msg="[db] Successfully connected to PostgreSQL!"
time=2025-10-30T23:05:33.675+05:30 level=INFO msg="[main] Database connection successful."
time=2025-10-30T23:05:33.675+05:30 level=INFO msg="[main] Running database migrations..."
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Starting database migrations..."
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Running migration for table: Users"
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Successfully migrated table: Users"
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Running migration for table: OTP Codes"
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Successfully migrated table: OTP Codes"
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Running migration for table: Seats"
time=2025-10-30T23:05:33.676+05:30 level=INFO msg="[db] Successfully migrated table: Seats"
time=2025-10-30T23:05:33.677+05:30 level=INFO msg="[db] Running migration for table: Concerts"
time=2025-10-30T23:05:33.677+05:30 level=INFO msg="[db] Successfully migrated table: Concerts"
time=2025-10-30T23:05:33.677+05:30 level=INFO msg="[db] Running migration for table: Participants"
time=2025-10-30T23:05:33.677+05:30 level=INFO msg="[db] Successfully migrated table: Participants"
time=2025-10-30T23:05:33.677+05:30 level=INFO msg="[db] Running migration for table: Payments"
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[db] Successfully migrated table: Payments"
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[db] Running migration for table: Bookings"
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[db] Successfully migrated table: Bookings"
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[db] All migrations completed successfully."
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[main] Database migrations completed successfully."
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[router] Registering public authentication and read-only routes."
time=2025-10-30T23:05:33.678+05:30 level=INFO msg="[router] Configuring '/api/v1' protected group (JWT Required)."
time=2025-10-30T23:05:33.679+05:30 level=WARN msg="[router] Configuring '/api/v1/admin' group (Admin Role Required)."
time=2025-10-30T23:05:33.679+05:30 level=INFO msg="[router] Admin: Seats CRUD configured."
time=2025-10-30T23:05:33.679+05:30 level=INFO msg="[router] Admin: Concerts CRUD configured."
time=2025-10-30T23:05:33.679+05:30 level=INFO msg="[router] Admin: Participants CRUD configured."
time=2025-10-30T23:05:33.679+05:30 level=INFO msg="[router] Admin: Payments CRUD configured."
time=2025-10-30T23:05:33.679+05:30 level=INFO msg="[router] Admin: Booking Update/Delete configured."
time=2025-10-30T23:05:46.813+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T23:05:46.826+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T23:05:46.830+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T23:05:46.923+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T23:05:46.930+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T23:05:46.998+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T23:05:47.078+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T23:05:47.094+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T23:05:47.134+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T23:05:47.221+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T23:05:47.253+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T23:05:47.260+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 1 pending bookings."
time=2025-10-30T23:05:58.172+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T23:05:58.172+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/:bookingID/verify. Required role: Admin. User role: admin"
time=2025-10-30T23:05:58.174+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T23:05:58.175+05:30 level=INFO msg="[booking-controller] Verification requested: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2 → approve"
time=2025-10-30T23:05:58.177+05:30 level=INFO msg="[approve-booking-uc] Approving booking: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T23:05:58.178+05:30 level=INFO msg="[get-booking-uc] Starting standard read for BookingID: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T23:05:58.179+05:30 level=INFO msg="[get-booking-uc] Executing standard DB query for ID: f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T23:05:58.689+05:30 level=INFO msg="[get-booking-uc] Booking f07db260-9a9c-4f1e-94ff-80fe3e5b86a2 retrieved successfully. Status: VERIFYING."
time=2025-10-30T23:05:58.717+05:30 level=INFO msg="[approve-booking-uc] 🎟️ ConcertID raw value (type: string): 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T23:05:58.722+05:30 level=INFO msg="[get-concert-uc] Starting retrieval for concert ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T23:05:58.723+05:30 level=INFO msg="[get-concert-uc] Executing SELECT query for ID: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T23:05:58.725+05:30 level=INFO msg="[get-concert-uc] Successfully retrieved concert: 459f268a-7396-4eb4-bcd3-bc4ecc3914c0"
time=2025-10-30T23:05:58.728+05:30 level=INFO msg="[approve-booking-uc] 🎵 Concert found: adsa @ 2025-10-30T22:41, fadfasdf"
time=2025-10-30T23:05:58.729+05:30 level=INFO msg="[get-payment-details-uc] Starting retrieval for PaymentID: 2141c1aa-a6e7-4ebd-b3fb-6c481bca25f6"
time=2025-10-30T23:05:58.730+05:30 level=INFO msg="[get-payment-details-uc] Executing SELECT query for ID: 2141c1aa-a6e7-4ebd-b3fb-6c481bca25f6"
time=2025-10-30T23:05:58.737+05:30 level=INFO msg="[get-payment-details-uc] Payment 2141c1aa-a6e7-4ebd-b3fb-6c481bca25f6 retrieved successfully. Type: UPI."
time=2025-10-30T23:05:58.744+05:30 level=INFO msg="[approve-booking-uc] ✅ Booking f07db260-9a9c-4f1e-94ff-80fe3e5b86a2 marked APPROVED."
time=2025-10-30T23:05:58.766+05:30 level=INFO msg="[approve-booking-uc] 📄 PDF generated successfully for f07db260-9a9c-4f1e-94ff-80fe3e5b86a2"
time=2025-10-30T23:06:01.342+05:30 level=INFO msg="[auth] ✅ Email sent to kalaiselvan7834@gmail.com via Resend."
time=2025-10-30T23:06:01.350+05:30 level=INFO msg="[approve-booking-uc] ✉️ Approval email with PDF sent to kalaiselvan7834@gmail.com"
time=2025-10-30T23:06:03.786+05:30 level=INFO msg="[auth] ✅ JWT validated. UserID: 157f8d03-770e-455a-8576-82108f2833e4, Role: admin"
time=2025-10-30T23:06:03.876+05:30 level=INFO msg="[auth] RBAC check for path /api/v1/admin/bookings/pending. Required role: Admin. User role: admin"
time=2025-10-30T23:06:03.938+05:30 level=INFO msg="[auth] RBAC PASSED for Admin UserID: 157f8d03-770e-455a-8576-82108f2833e4"
time=2025-10-30T23:06:03.942+05:30 level=INFO msg="[booking-controller] Fetching all pending bookings (Admin)"
time=2025-10-30T23:06:03.954+05:30 level=INFO msg="[get-pending-bookings-uc] Fetching all pending bookings for admin review."
time=2025-10-30T23:06:04.012+05:30 level=INFO msg="[get-pending-bookings-uc] Retrieved 0 pending bookings."
